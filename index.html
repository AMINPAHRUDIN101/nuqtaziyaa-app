<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuqtazi Ziyaa Fotografi Manajemen</title>
<link rel="manifest" href="manifest.json">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  // ====== Konfigurasi Firebase ======
  const firebaseConfig = {
    apiKey: "API_KEY",
    authDomain: "PROJECT_ID.firebaseapp.com",
    projectId: "PROJECT_ID",
    storageBucket: "PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  // ====== Inisialisasi Firebase ======
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  color:#fff;
  background:url('images/nuqtazi_ziyaa_bg.png') no-repeat center center fixed;
  background-size:cover;
}

header{
  background:rgba(0,0,0,.65);
  padding:16px;
  text-align:center;
  backdrop-filter:blur(6px);
}

header img{
  width:70px;
  height:70px;
  border-radius:50%;
  margin-bottom:8px;
}

nav{
  display:flex;
  background:rgba(0,0,0,.75);
}

nav button{
  flex:1;
  padding:12px;
  background:none;
  border:none;
  color:#fff;
  font-size:14px;
}

nav button.active{
  background:rgba(255,255,255,.15);
}

section{
  display:none;
  padding:16px;
}

section.active{
  display:block;
}

.card{
  background:rgba(0,0,0,.6);
  border-radius:10px;
  padding:12px;
  margin-bottom:12px;
}

input,select,textarea{
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  border:none;
}

button.primary{
  width:100%;
  padding:10px;
  border:none;
  border-radius:6px;
  background:#fff;
  color:#000;
  font-weight:bold;
}

.list-item{
  border-bottom:1px solid rgba(255,255,255,.2);
  padding:8px 0;
}

.small{
  font-size:12px;
  opacity:.8;
}
</style>
</head>

<body>

<header>
  <img src="images/nuqtazi_ziyaa_bg.png">
  <h2>Nuqtazi Ziyaa</h2>
  <div class="small">Fotografi Manajemen</div>
</header>

<nav>
  <button class="active" onclick="showTab('dashboard',this)">Dashboard</button>
  <button onclick="showTab('klien',this)">Klien</button>
  <button onclick="showTab('job',this)">Job</button>
  <button onclick="showTab('keuangan',this)">Keuangan</button>
</nav>

<section id="dashboard" class="active">
  <div class="card"><b>Total Klien</b><div id="totalKlien">0</div></div>
  <div class="card"><b>Total Job</b><div id="totalJob">0</div></div>
  <div class="card"><b>Total Pemasukan</b><div id="totalUang">Rp 0</div></div>
</section>

<section id="klien">
  <div class="card">
    <h3>Tambah Klien</h3>
    <input id="kNama" placeholder="Nama Klien">
    <input id="kKontak" placeholder="Kontak (WA / IG)">
    <select id="kTipe">
      <option>Wedding</option>
      <option>Event</option>
      <option>Produk</option>
      <option>Personal</option>
    </select>
    <button class="primary" onclick="tambahKlien()">Simpan</button>
  </div>

  <div class="card">
    <h3>Daftar Klien</h3>
    <div id="listKlien"></div>
  </div>
</section>

<section id="job">
  <div class="card">
    <h3>Tambah Job</h3>
    <input id="jNama" placeholder="Nama Project">
    <input id="jTanggal" type="date">
    <select id="jKlien"></select>
    <input id="jHarga" type="number" placeholder="Harga">
    <select id="jStatus">
      <option>On Progress</option>
      <option>Editing</option>
      <option>Selesai</option>
    </select>
    <button class="primary" onclick="tambahJob()">Simpan</button>
  </div>

  <div class="card">
    <input type="date" id="filterTanggal" onchange="renderJobs()">
    <h3>Daftar Job</h3>
    <div id="listJob"></div>
  </div>
</section>

<section id="keuangan">
  <div class="card">
    <h3>Tambah Pemasukan</h3>
    <input id="uJumlah" type="number" placeholder="Jumlah">
    <textarea id="uCatatan" placeholder="Catatan"></textarea>
    <button class="primary" onclick="tambahUang()">Simpan</button>
  </div>

  <div class="card">
    <h3>Riwayat</h3>
    <div id="listUang"></div>
  </div>
</section>

<script>
/* ================= TAB ================= */
function showTab(id,el){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
}

/* ================= FIRESTORE OPERATIONS ================= */
// Tambah Klien
function tambahKlien(){
  const nama = document.getElementById('kNama').value;
  const kontak = document.getElementById('kKontak').value;
  const tipe = document.getElementById('kTipe').value;

  db.collection("klien").add({ nama, kontak, tipe })
    .then(() => {
      document.getElementById('kNama').value = '';
      document.getElementById('kKontak').value = '';
      renderKlien();
    });
}

// Render Klien
function renderKlien(){
  db.collection("klien").get().then(snapshot => {
    const list = document.getElementById('listKlien');
    list.innerHTML = '';
    snapshot.forEach(doc => {
      const k = doc.data();
      list.innerHTML += `
        <div class="list-item">
          ${k.nama}
          <div class="small">${k.tipe}</div>
        </div>
      `;
    });

    // Update select job
    const jKlien = document.getElementById('jKlien');
    jKlien.innerHTML = '';
    snapshot.forEach(doc => {
      const k = doc.data();
      jKlien.innerHTML += `<option>${k.nama}</option>`;
    });

    document.getElementById('totalKlien').innerText = snapshot.size;
  });
}

// Tambah Job
function tambahJob(){
  const nama = document.getElementById('jNama').value;
  const tanggal = document.getElementById('jTanggal').value;
  const klien = document.getElementById('jKlien').value;
  const harga = Number(document.getElementById('jHarga').value);
  const status = document.getElementById('jStatus').value;

  db.collection("job").add({ nama, tanggal, klien, harga, status })
    .then(() => {
      document.getElementById('jNama').value = '';
      document.getElementById('jHarga').value = '';
      renderJobs();
    });
}

// Render Job
function renderJobs(){
  const tglFilter = document.getElementById('filterTanggal').value;
  db.collection("job").get().then(snapshot => {
    const listJob = document.getElementById('listJob');
    listJob.innerHTML = '';
    let totalJob = 0;
    let totalUang = 0;

    snapshot.forEach(doc => {
      const j = doc.data();
      if(!tglFilter || j.tanggal === tglFilter){
        listJob.innerHTML += `
          <div class="list-item">
            ${j.nama} 
            <div class="small">${j.tanggal} â€¢ ${j.status}</div>
          </div>
        `;
        totalJob++;
        totalUang += j.harga;
      }
    });

    document.getElementById('totalJob').innerText = totalJob;
    document.getElementById('totalUang').innerText = 'Rp ' + totalUang.toLocaleString('id-ID');
  });
}

// Tambah Uang
function tambahUang(){
  const jumlah = Number(document.getElementById('uJumlah').value);
  const catatan = document.getElementById('uCatatan').value;

  db.collection("uang").add({ jumlah, catatan })
    .then(() => {
      document.getElementById('uJumlah').value = '';
      document.getElementById('uCatatan').value = '';
      renderUang();
    });
}

// Render Uang
function renderUang(){
  db.collection("uang").get().then(snapshot => {
    const listUang = document.getElementById('listUang');
    listUang.innerHTML = '';
    snapshot.forEach(doc => {
      const u = doc.data();
      listUang.innerHTML += `
        <div class="list-item">
          Rp ${u.jumlah.toLocaleString('id-ID')}
          ${u.catatan ? `<div class="small">${u.catatan}</div>` : ''}
        </div>
      `;
    });
  });
}

// ====== Inisialisasi render ======
renderKlien();
renderJobs();
renderUang();

</script>
</body>
</html>
