<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuqtazi Ziyaa Fotografi Manajemen</title>
<link rel="manifest" href="manifest.json">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  // ====== Konfigurasi Firebase ======
  const firebaseConfig = {
    apiKey: "API_KEY",
    authDomain: "PROJECT_ID.firebaseapp.com",
    projectId: "PROJECT_ID",
    storageBucket: "PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  // ====== Inisialisasi Firebase ======
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  color:#fff;
  background:url('images/nuqtazi_ziyaa_bg.png') no-repeat center center fixed;
  background-size:cover;
}

header{
  background:rgba(0,0,0,.65);
  padding:16px;
  text-align:center;
  backdrop-filter:blur(6px);
}

header img{
  width:70px;
  height:70px;
  border-radius:50%;
  margin-bottom:8px;
}

nav{
  display:flex;
  background:rgba(0,0,0,.75);
}

nav button{
  flex:1;
  padding:12px;
  background:none;
  border:none;
  color:#fff;
  font-size:14px;
}

nav button.active{
  background:rgba(255,255,255,.15);
}

section{
  display:none;
  padding:16px;
}

section.active{
  display:block;
}

.card{
  background:rgba(0,0,0,.6);
  border-radius:10px;
  padding:12px;
  margin-bottom:12px;
}

input,select,textarea{
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  border:none;
}

button.primary{
  width:100%;
  padding:10px;
  border:none;
  border-radius:6px;
  background:#fff;
  color:#000;
  font-weight:bold;
}

button.danger{
  padding:4px 8px;
  border:none;
  border-radius:4px;
  background:red;
  color:#fff;
  margin-left:8px;
  font-size:12px;
}

button.edit{
  padding:4px 8px;
  border:none;
  border-radius:4px;
  background:orange;
  color:#fff;
  margin-left:8px;
  font-size:12px;
}

.list-item{
  border-bottom:1px solid rgba(255,255,255,.2);
  padding:8px 0;
}

.small{
  font-size:12px;
  opacity:.8;
}
</style>
</head>

<body>

<header>
  <img src="images/nuqtazi_ziyaa_bg.png">
  <h2>Nuqtazi Ziyaa</h2>
  <div class="small">Fotografi Manajemen</div>
</header>

<nav>
  <button class="active" onclick="showTab('dashboard',this)">Dashboard</button>
  <button onclick="showTab('klien',this)">Klien</button>
  <button onclick="showTab('job',this)">Job</button>
  <button onclick="showTab('keuangan',this)">Keuangan</button>
</nav>

<section id="dashboard" class="active">
  <div class="card"><b>Total Klien</b><div id="totalKlien">0</div></div>
  <div class="card"><b>Total Job</b><div id="totalJob">0</div></div>
  <div class="card"><b>Total Pemasukan</b><div id="totalUang">Rp 0</div></div>
</section>

<section id="klien">
  <div class="card">
    <h3>Tambah / Edit Klien</h3>
    <input id="kNama" placeholder="Nama Klien">
    <input id="kKontak" placeholder="Kontak (WA / IG)">
    <select id="kTipe">
      <option>Wedding</option>
      <option>Event</option>
      <option>Produk</option>
      <option>Personal</option>
    </select>
    <input type="hidden" id="kId">
    <button class="primary" onclick="simpanKlien()">Simpan</button>
  </div>

  <div class="card">
    <h3>Daftar Klien</h3>
    <div id="listKlien"></div>
  </div>
</section>

<section id="job">
  <div class="card">
    <h3>Tambah / Edit Job</h3>
    <input id="jNama" placeholder="Nama Project">
    <input id="jTanggal" type="date">
    <select id="jKlien"></select>
    <input id="jHarga" type="number" placeholder="Harga">
    <select id="jStatus">
      <option>On Progress</option>
      <option>Editing</option>
      <option>Selesai</option>
    </select>
    <input type="hidden" id="jId">
    <button class="primary" onclick="simpanJob()">Simpan</button>
  </div>

  <div class="card">
    <input type="date" id="filterTanggal" onchange="renderJobs()">
    <h3>Daftar Job</h3>
    <div id="listJob"></div>
  </div>
</section>

<section id="keuangan">
  <div class="card">
    <h3>Tambah Pemasukan</h3>
    <input id="uJumlah" type="number" placeholder="Jumlah">
    <textarea id="uCatatan" placeholder="Catatan"></textarea>
    <input type="hidden" id="uId">
    <button class="primary" onclick="simpanUang()">Simpan</button>
  </div>

  <div class="card">
    <h3>Riwayat</h3>
    <div id="listUang"></div>
  </div>
</section>

<script>
/* ================= TAB ================= */
function showTab(id,el){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
}

/* ================= KLIEN ================= */
function simpanKlien(){
  const nama = document.getElementById('kNama').value;
  const kontak = document.getElementById('kKontak').value;
  const tipe = document.getElementById('kTipe').value;
  const id = document.getElementById('kId').value;

  if(id){
    db.collection("klien").doc(id).update({nama, kontak, tipe}).then(()=>{
      resetKlienForm();
      renderKlien();
    });
  } else {
    db.collection("klien").add({nama, kontak, tipe}).then(()=>{
      resetKlienForm();
      renderKlien();
    });
  }
}

function editKlien(id, data){
  document.getElementById('kNama').value = data.nama;
  document.getElementById('kKontak').value = data.kontak;
  document.getElementById('kTipe').value = data.tipe;
  document.getElementById('kId').value = id;
}

function hapusKlien(id){
  if(confirm('Hapus klien ini?')){
    db.collection("klien").doc(id).delete().then(renderKlien);
  }
}

function resetKlienForm(){
  document.getElementById('kNama').value='';
  document.getElementById('kKontak').value='';
  document.getElementById('kTipe').value='Wedding';
  document.getElementById('kId').value='';
}

function renderKlien(){
  db.collection("klien").get().then(snapshot=>{
    const list = document.getElementById('listKlien');
    const jKlien = document.getElementById('jKlien');
    list.innerHTML='';
    jKlien.innerHTML='';
    snapshot.forEach(doc=>{
      const k = doc.data();
      const id = doc.id;
      list.innerHTML += `
        <div class="list-item">
          ${k.nama} 
          <div class="small">${k.tipe}</div>
          <button class="edit" onclick='editKlien("${id}", ${JSON.stringify(k)})'>Edit</button>
          <button class="danger" onclick='hapusKlien("${id}")'>Hapus</button>
        </div>
      `;
      jKlien.innerHTML += `<option>${k.nama}</option>`;
    });
    document.getElementById('totalKlien').innerText = snapshot.size;
  });
}

/* ================= JOB ================= */
function simpanJob(){
  const nama = document.getElementById('jNama').value;
  const tanggal = document.getElementById('jTanggal').value;
  const klien = document.getElementById('jKlien').value;
  const harga = Number(document.getElementById('jHarga').value);
  const status = document.getElementById('jStatus').value;
  const id = document.getElementById('jId').value;

  if(id){
    db.collection("job").doc(id).update({nama, tanggal, klien, harga, status}).then(()=>{
      resetJobForm();
      renderJobs();
    });
  } else {
    db.collection("job").add({nama, tanggal, klien, harga, status}).then(()=>{
      resetJobForm();
      renderJobs();
    });
  }
}

function editJob(id, data){
  document.getElementById('jNama').value=data.nama;
  document.getElementById('jTanggal').value=data.tanggal;
  document.getElementById('jKlien').value=data.klien;
  document.getElementById('jHarga').value=data.harga;
  document.getElementById('jStatus').value=data.status;
  document.getElementById('jId').value=id;
}

function hapusJob(id){
  if(confirm('Hapus job ini?')){
    db.collection("job").doc(id).delete().then(renderJobs);
  }
}

function resetJobForm(){
  document.getElementById('jNama').value='';
  document.getElementById('jTanggal').value='';
  document.getElementById('jKlien').value='';
  document.getElementById('jHarga').value='';
  document.getElementById('jStatus').value='On Progress';
  document.getElementById('jId').value='';
}

function renderJobs(){
  const tglFilter = document.getElementById('filterTanggal').value;
  db.collection("job").get().then(snapshot=>{
    const list = document.getElementById('listJob');
    list.innerHTML='';
    let totalJob = 0;
    let totalUang = 0;
    snapshot.forEach(doc=>{
      const j = doc.data();
      if(!tglFilter || j.tanggal === tglFilter){
        list.innerHTML += `
          <div class="list-item">
            ${j.nama} 
            <div class="small">${j.tanggal} â€¢ ${j.status}</div>
            <button class="edit" onclick='editJob("${doc.id}", ${JSON.stringify(j)})'>Edit</button>
            <button class="danger" onclick='hapusJob("${doc.id}")'>Hapus</button>
          </div>
        `;
        totalJob++;
        totalUang += j.harga;
      }
    });
    document.getElementById('totalJob').innerText=totalJob;
    document.getElementById('totalUang').innerText='Rp '+totalUang.toLocaleString('id-ID');
  });
}

/* ================= UANG ================= */
function simpanUang(){
  const jumlah=Number(document.getElementById('uJumlah').value);
  const catatan=document.getElementById('uCatatan').value;
  const id=document.getElementById('uId').value;

  if(id){
    db.collection("uang").doc(id).update({jumlah,catatan}).then(()=>{
      resetUangForm();
      renderUang();
    });
  } else {
    db.collection("uang").add({jumlah,catatan}).then(()=>{
      resetUangForm();
      renderUang();
    });
  }
}

function editUang(id, data){
  document.getElementById('uJumlah').value=data.jumlah;
  document.getElementById('uCatatan').value=data.catatan;
  document.getElementById('uId').value=id;
}

function hapusUang(id){
  if(confirm('Hapus pemasukan ini?')){
    db.collection("uang").doc(id).delete().then(renderUang);
  }
}

function resetUangForm(){
  document.getElementById('uJumlah').value='';
  document.getElementById('uCatatan').value='';
  document.getElementById('uId').value='';
}

function renderUang(){
  db.collection("uang").get().then(snapshot=>{
    const list=document.getElementById('listUang');
    list.innerHTML='';
    snapshot.forEach(doc=>{
      const u=doc.data();
      list.innerHTML += `
        <div class="list-item">
          Rp ${u.jumlah.toLocaleString('id-ID')}
          ${u.catatan? `<div class="small">${u.catatan}</div>`:''}
          <button class="edit" onclick='editUang("${doc.id}", ${JSON.stringify(u)})'>Edit</button>
          <button class="danger" onclick='hapusUang("${doc.id}")'>Hapus</button>
        </div>
      `;
    });
  });
}

// ====== Inisialisasi render ======
renderKlien();
renderJobs();
renderUang();
</script>
</body>
</html>
